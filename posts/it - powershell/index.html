<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PowerShell">
    <title>PowerShell</title>
    <link rel="icon" href="../../images/favicon.png">
    <link rel="stylesheet" href="../../css/style.css">
  </head>
  <body>
    <article>
      <h2>PowerShell</h2>
      <p>PowerShell được phát triển để thay thế CMD.</p>
      <p>PowerShell được xây dựng trên .NET.</p>
      <p>Để khởi động PowerShell, vào hộp thoại Run hoặc Search và gõ <code>powershell</code>.</p>
      <p>Các file script có phần mở rộng là <code>ps1</code>. Bạn không thể
        click đúp file ps1 để chạy (để tránh tổn hại ngoài ý muốn), mà phải
        click chuột phải và chọn <strong>Run with PowerShell</strong>.</p>
      <figure><img src="images/run%20with%20powershell.png" alt=""></figure>
      <p>Các lệnh của PowerShell còn được gọi là <em>cmdlet</em>.</p>
      <h3>Phiên bản</h3>
      <p>Để kiểm tra phiên bản PowerShell của bạn, chạy câu lệnh Get-Host và
        kiểm tra thuộc tính version.</p>
      <figure><img src="images/version.png" alt=""></figure>
      <p>Máy tính của tôi sử dụng PowerShell phiên bản 5.1 trên hệ điều hành
        Windows 10.</p>
      <h3>Chính sách thực thi</h3>
      <p>PowerShell có một giao thức an ninh rất độc đáo, gọi là chính sách thực
        thi (execution policy), cho phép bạn định nghĩa loại script mà có thể
        chạy trên máy hoặc workgroup của bạn.</p>
      <p>Mặc định, PowerShell chỉ cho phép bạn thực thi script qua shell tương
        tác của nó, ngăn việc thực thi các script ngoài. Tuy nhiên, bằng cách
        thiết lập cấp độ security cao nhất, bạn có thể dẽ dàng thiết lập các cấp
        độ security. Danh sách các chính sách như dưới:</p>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Chính sách thực thi</th>
            <th>Cấp độ security</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Restricted</td>
            <td>Chỉ cho phép thực thi shell tương tác</td>
          </tr>
          <tr>
            <td>AllSigned</td>
            <td>Chạy các script với chữ ký số. Việc thực thi một script lần đầu
              tiên sẽ hiển thị một thông báo tin tưởng publisher</td>
          </tr>
          <tr>
            <td>RemoteSigned</td>
            <td>Tất cả script từ Internet phải được ký</td>
          </tr>
          <tr>
            <td>Unrestricted</td>
            <td>Cho phép bất kỳ sự thực thi script nào. Script từ Internet phải
              được tin tưởng.</td>
          </tr>
          <tr>
            <td>ByPass</td>
            <td>Tất cả sự thực thi script phải được xác thực bởi người dùng</td>
          </tr>
        </tbody>
      </table>
      <p>Để thay đổi chính sách thực thi của bạn, bạn phải sử dụng shell tương
        tác. Hãy chắc chắn rằng bạn <strong>Run as Administrator</strong>. Sử
        dụng câu lệnh <code>Set-ExecutionPolicy</code> để thay đổi nó thành cái
        bạn muốn.</p>
      <p>Để xem chính sách thực thi hiện tại, bạn có thể sử dụng câu lệnh <code>Get-ExecutionPolicy</code>.</p>
      <figure><img src="images/execution%20policy.png" alt=""></figure>
      <p>Chú ý: Nếu chính sách thực thi đang là Restricted, bạn vẫn có thể click
        chuột phải vào file script và chọn <strong>Run with PowerShell</strong>.
        Bạn chỉ không thể thực hiện bằng lệnh bên trong PowerShell (ví dụ <code>.\Hello_World.ps1</code>)
        thôi.</p>
      <h3>In ra và lấy dữ liệu từ shell tương tác</h3>
      <p>Sử dụng câu lệnh <code>Write-Host</code>:</p>
      <pre>Write-Host Hello World
Write-Host "Hello World"
Write-Host -ForegroundColor White -BackgroundColor Black "Hello World"</pre>
      <p>Khi PowerShell tìm thấy một string mà không ở trong một ngữ cảnh nào,
        nó sẽ in ra giá trị của string. Nếu bạn muốn in ra một biến, chỉ việc
        viết tên của nó.</p>
      <p>Để lấy một giá trị từ shell tương tác, bạn có thể sử dụng câu lệnh <code>Read-Host</code>.
        Câu lệnh sẽ đọc một dòng từ console.</p>
      <figure><img src="images/read-host.png"></figure>
      <h3>Sử dụng các lớp .NET<br>
      </h3>
      <p>Để sử dụng một lớp .NET trong PowerShell, bạn chỉ cần xác định
        namespace giữa các ngoặc vuông, sau đó sử dụng hai dấu hai chấm để gọi
        phương thức mà bạn muốn. Các tham số được truyền vào cùng cách trong
        .NET. Ví dụ, bạn có thể xem ngày và giờ hiện tại bằng lệnh sau:</p>
      <pre>[DateTime]::Now</pre>
      <h3>Biến</h3>
      <p>Các biến được sử dụng trong mọi ngôn ngữ lập trình để lưu thông tin mà
        bạn muốn điều chỉnh sau này trong chương trình hoặc script của bạn. Điều
        này cũng đúng trong PowerShell. Các biến được sử dụng để lưu thông tin
        về kết quả một câu lệnh để sử dụng sau này hoặc để truyền nó vào
        pipeline.</p>
      <p>Trong PowerShell, các biến bắt đầu bằng ký tự dollar <code>$</code> và
        theo sau bằng gần như ký tự bất kỳ. Ràng buộc duy nhất là các ký tự đặc
        biệt. PowerShell chỉ giải phóng các biến khi mà phiên của người dùng kết
        thúc. Nếu bạn không muốn sử dụng một biến nào đó nữa, clean nó bằng cách
        gán biến <code>$null</code> cho nó.</p>
      <pre>$var1 = $null</pre>
      <p>Kiểu đối tượng biến được xác định động, nghĩa là nếu bạn gán một xâu
        thì kiểu của biến là xâu, tùy giá trị bạn gán. Tuy nhiên, bạn cũng có
        thể ép kiểu một biến sang kiểu khác sử dụng kiểu bên trong ngoặc vuông <code>[]</code>
        trước tên biến. Điều này có thể hữu ích khi bạn không muốn tạo một biến
        khác.</p>
      <figure><img src="images/variable%20casting.png" alt=""></figure>
      <pre>$var4 = [System.Xml.XmlDocument]"&lt;xml&gt;&lt;node&gt;HERE&lt;/node&gt;&lt;/xml&gt;"</pre>
      <p>Các biến có thể được định nghĩa với các phạm vi khác nhau.</p>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Phạm vi</th>
            <th>Mô tả</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Script</td>
            <td>Chỉ sẵn có trong script đó</td>
          </tr>
          <tr>
            <td>Local</td>
            <td>Chỉ sẵn có trong một phạm vi chỉ định hoặc phạm vi con, như một
              vòng lặp và các vòng lặp bên trong</td>
          </tr>
          <tr>
            <td>Private</td>
            <td>Chỉ sẵn có trong một phạm vi, như trong một vòng lặp</td>
          </tr>
          <tr>
            <td>Global</td>
            <td>Sẵn có trên toàn bộ shell</td>
          </tr>
        </tbody>
      </table>
      <p>Phạm vi mặc định của một biến phụ thuộc vào nơi mà bạn định nghĩa nó.
        Nếu nó được định nghĩa trong shell tương tác, phạm vi là Global. Nếu
        ngoài hàm và các khối script, phạm vi là Script. Còn lại là Local.</p>
      <p>Lấy thuộc tính của một Item</p>
      <p><br>
      </p>
      <h4>Định dạng output của biến</h4>
      <p>Có ba lệnh để định dạng output của một biến. Bạn có thể sử dụng
        Format-List để định dạng như một danh sách dọc, Format-Table để định
        dạng như một bảng, Format-Wide để lấy phần tử và hiển thị nhiều cột.</p>
      <pre>Get-Process | Format-List

Get-Process | Format-Table

Get-Process | Format-Wide

# Choose how many columns you want
Get-Process | Format-Wide -Column 3</pre>
      <h3>Xâu</h3>
      <p>Xâu là kiểu dữ liệu sử dụng nhiều nhất trong các ngôn ngữ lập trình và
        PowerShell không phải là ngoại lệ. Mặc định, các xâu trong PowerShell là
        các đối tượng System.String trong .NET, nghĩa là khi bạn khởi tạo một
        biến với một giá trị xâu, PowerShell sẽ khởi tạo một đối tượng
        System.String với các thuộc tính và phương thức của nó.</p>
      <pre>$myVar = "PowerShell"
($myVar -is [System.String])</pre>
      <p>Chú ý phân biệt các xâu literal và expanding. Trong các xâu literal,
        được bao giữa dấu nháy đơn <code>'</code> và tất cả là phần của xâu.
        Khi bạn bao bằng dấu nháy kép <code>"</code>, PowerShell thay thế tất
        cả các tên biến và các ký tự đặc biệt.</p>
      <pre>$a = "SyncFusion"

# Literal string
$literal = '$a`n and PowerShell'

$literal

# Expanding string
$expanding = "$a`n and PowerShell"

$expanding</pre>
      <h4>Here string</h4>
      <p>PowerShell cung cấp một tính năng hay mà đơn giản cách bạn quản lý các
        xâu lớn. Cái này cho phép bạn định nghĩa các xâu nhiều dòng mà không
        phải cộng nhiều xâu lại với nhau. Để sử dụng here string, bạn bắt đầu
        bằng ký tự đặc biệt <code>@</code>, dấu nháy kép <code>"</code>, sau
        đó là dòng mới, và kết thúc bằng dấu nháy kép <code>"</code> cùng ký tự
        <code>@</code>.</p>
      <pre># Simple string
$simpleString = "Example String"

# Empty here string
@"

"@

# PowerShell here string
$largeString = @"
    Hello, this
    is a PowerShell here string. You can define
    multiple string lines into one single text block.

    You can even use special characters like `n or expand it with another string
    $simpleString
"@

$largeString</pre>
      <h3>Biểu thức chính quy</h3>
      <p>Biểu thức chính quy là một cách dễ dàng và rất hiệu quả để tìm kiếm các
        mẫu trong xâu. Trong khi phát triển các script, bạn sẽ cần sử dụng biểu
        thức chính quy trong một số ngữ cảnh, trong đó có thể bao gồm việc thay
        thế các văn bản trong xâu, lấy ra các phần tử trong XML. Để sử dụng biểu
        thức chính quy trong PowerShell, bạn có thể sử dụng toán tử <code>-match</code>
        nếu bạn chỉ muốn đánh giá một mẫu trong một xâu hoặc toán tử <code>-replace</code>
        nếu bạn muốn thay thế các ký tự trong một xâu dựa vào một mẫu. Đoạn code
        xâu chỉ cho bạn cách sử dụng toán tử <code>-match</code>.</p>
      <pre><code class="language-powershell"># Text to evaluate
$text = @"
	This is a PowerShell string!
    We will use it to test regular expressions
"@

# Evaluate a pattern. Returns: True
$text -match "\w"

# Evaluate a pattern. Returns: False
$text -match "!\w+"</code></pre>
      <p>Ví dụ sử dụng toán tử <code>-replace</code>:</p>
      <pre># Text to evaluate
$text = @"
    This is a PowerShell string!
    We will use it to test regular expressions
"@

# Replace every character with the A character
$text -replace "\w", "A"

# Replace every string followed by ! with the B character
$text -replace "\w+!", "B"</pre>
      <h3>Mảng</h3>
      <p>Để tạo một mảng trong PowerShell, bạn có thể sử dụng một trong hai tùy
        chọn:</p>
      <p>Khai báo nó một cách tường mình bằng cách bao các giá trị vào trong @(
        ) và ngăn cách bằng dấu phảy</p>
      <p>Khi báo </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p>Danh sách .NET</p>
      <p><br>
      </p>
      <p>Hash Table</p>
      <p><br>
      </p>
      <p>Dòng điều khiển</p>
      <p>Toán tử logic và so sánh</p>
      <p>Mệnh đề điều kiện</p>
      <p>Switch</p>
      <p>Vòng lặp</p>
      <p><br>
      </p>
      <p><br>
      </p>
      <h3>Định nghĩa hàm</h3>
      <p><br>
      </p>
      <p>Lệnh if (khối điều kiện)</p>
      <p><br>
      </p>
      <p>Vòng lặp</p>
      <p><br>
      </p>
      <p><br>
      </p>
      <h3>Pipeline</h3>
      <p>Pipeline sẽ truyền dữ liệu từ một cmdlet này sang cmdlet khác.</p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p>PowerShell có thể nói chuyện</p>
      <pre>Add-Type -AssemblyName System.speech
$synth = New-Object -TypeName System.Speech.Synthesis.SpeechSynthesizer
$synth.Speak("PowerShell to the people")</pre>
      <p><br>
      </p>
      <p><br>
      </p>
      <h3>So sánh các cmdlet với các lệnh tương tự</h3>
      <p>Các lệnh không phân biệt chữ hoa thường.</p>
      <div class="out-of-box">
        <table class="table table-bordered table-responsive-lg">
          <thead>
            <tr>
              <th>PowerShell (Cmdlet)</th>
              <th>PowerShell (Alias)</th>
              <th>Windows Command Prompt</th>
              <th>Unix shell</th>
              <th>Mô tả</th>
              <th>Ví dụ</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Get-ChildItem</td>
              <td>gci, dir, ls</td>
              <td>dir</td>
              <td>ls</td>
              <td>Liệt kê tất cả file và folder trong thư mục hiện tại hoặc thư
                mục chỉ định</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Test-Connection</td>
              <td>ping</td>
              <td>ping</td>
              <td>ping</td>
              <td>Thực hiện ping đến một máy nào đó</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Get-Content</td>
              <td>gc, type, cat</td>
              <td>type</td>
              <td>cat</td>
              <td>Lấy nội dung của một file</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Get-Command</td>
              <td>gcm</td>
              <td>help, where</td>
              <td>type, which, compgen</td>
              <td>Liệt kê các lệnh sẵn có và lấy đường dẫn của lệnh</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Get-Help</td>
              <td>help, man</td>
              <td>help</td>
              <td>apropos, man</td>
              <td>In ra documentation của lệnh ra console</td>
              <td>Get-Help -Name Get-Process<br>
              </td>
            </tr>
            <tr>
              <td>Clear-Host</td>
              <td>cls, clear</td>
              <td>cls</td>
              <td>clear</td>
              <td>Clear màn hình</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Copy-Item</td>
              <td>cpi, copy, cp</td>
              <td>copy, xcopy, robocopy</td>
              <td>cp</td>
              <td>Copy các file và folder đến nơi đích</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Move-Item</td>
              <td>mi, move, mv</td>
              <td>move</td>
              <td>mv</td>
              <td>Di chuyển file và folder đến nơi mới</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Remove-Item</td>
              <td>ri, del, erase, rmdir, rd, rm</td>
              <td>del, erase, rmdir, rd</td>
              <td>rm, rmdir</td>
              <td>Xóa file và folder</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Rename-Item</td>
              <td>rni, ren, mv</td>
              <td>ren, rename</td>
              <td>mv</td>
              <td>Đổi tên một file, folder, link</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Get-Location</td>
              <td>gl, cd, pwd</td>
              <td>cd</td>
              <td>pwd</td>
              <td>Hiển thị thư mục hiện tại</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Pop-Location</td>
              <td>popd</td>
              <td>popd</td>
              <td>popd</td>
              <td>Đổi thư mục làm việc tới nơi mới nhất được đẩy vào stack</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Set-Location</td>
              <td>pushd</td>
              <td>pushd</td>
              <td>pushd</td>
              <td>Lưu thư mục hiện tại vào trong stack</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Tee-Object</td>
              <td>tee</td>
              <td><br>
              </td>
              <td>tee</td>
              <td>Pipe đầu vào tới một file hoặc một biến, truyền đầu vào
                pipeline</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Write-Output</td>
              <td>echo, write</td>
              <td>echo</td>
              <td>echo</td>
              <td>In các xâu hoặc các đối tượng khác ra output chuẩn</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Get-Process</td>
              <td>gps, ps</td>
              <td>tlist, tasklist</td>
              <td>ps</td>
              <td>Liệt kê các tiến trình đang chạy</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Stop-Process</td>
              <td>spps, kill</td>
              <td>kill, taskkill</td>
              <td>kill</td>
              <td>Dừng một tiến trình đang chạy</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Select-String</td>
              <td>sls</td>
              <td>findstr</td>
              <td>find, grep</td>
              <td>In ra các dòng match một pattern nào đó</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Set-Variable</td>
              <td>sv, set</td>
              <td>set</td>
              <td>env, export, set, setenv</td>
              <td>Tạo hoặc sửa giá trị của một biến môi trường</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Invoke-WebRequest</td>
              <td>iwr</td>
              <td>curl</td>
              <td>wget, curl</td>
              <td>Lấy nội dung từ một trang web</td>
              <td><br>
              </td>
            </tr>
            <tr>
              <td>Get-History</td>
              <td><br>
              </td>
              <td><br>
              </td>
              <td><br>
              </td>
              <td><br>
              </td>
              <td><br>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <h3>Tham khảo</h3>
      <p><a href="https://en.wikipedia.org/wiki/PowerShell" target="_blank">PowerShell
          - Wikipedia</a></p>
      <p><a href="https://docs.microsoft.com/en-us/powershell/scripting/how-to-use-docs?view=powershell-7.1"
          target="_blank">How to use the PowerShell documentation - PowerShell |
          Microsoft Docs</a></p>
      <p><a href="https://quantrimang.com/bang-tong-hop-cac-lenh-powershell-co-ban-152785"
          target="_blank">Bảng tổng hợp các lệnh PowerShell cơ bản -
          Quantrimang.com</a> </p>
      <p><a href="https://anonyviet.com/huong-dan-lap-trinh-powershell-tren-windows/"
          target="_blank">Hướng dẫn lập trình PowerShell trên Windows</a> </p>
      <p><a href="https://books.goalkicker.com/PowerShellBook/" target="_blank">PowerShell
          Notes for Professionals book</a> </p>
      <p>---<br>
      </p>
      <p><a href="https://www.syncfusion.com/succinctly-free-ebooks/powershell"
          target="_blank">Free Ebook - PowerShell Succinctly</a></p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
    </article>
    <script src="../../js/docs.js"></script>
  </body>
</html>
