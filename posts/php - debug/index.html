<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="xdebug">
    <title>Debug PHP code</title>
    <link rel="icon" href="../../images/favicon.png">
    <link rel="stylesheet" href="../../css/style.css">
  </head>
  <body>
    <article>
      <h2>Debug PHP code</h2>
      <h3>Cài đặt PHP extension xdebug</h3>
      <h4>Ubuntu</h4>
      <p>Thực hiện lệnh sau:</p>
      <pre>sudo apt install php-xdebug</pre>
      <h4>Windows</h4>
      <p>Lấy thông tin của <code>phpinfo()</code>. Bạn có thể copy giao diện
        HTML, source HTML, hoặc output của lệnh <code>php -i</code>. Sau đó
        paste vào trang web sau:</p>
      <p><a href="https://xdebug.org/wizard" target="_blank">Xdebug: Support —
          Tailored Installation Instructions</a></p>
      <div class="mb-3 border"> <img src="images/installation%20wizard.png" alt="">
      </div>
      <p>Nhấn nút "Analyse my phpinfo() output", bạn sẽ được hướng dẫn từng
        bước:</p>
      <div class="mb-3 border"> <img src="images/analyse%20result.png" alt="">
      </div>
      <p>Bạn download file <code>dll</code>, copy vào thư mục <code>ext</code>
        của PHP, thêm dòng sau vào file <code>php.ini</code>:</p>
      <pre>; zend_extension=ext\php_xdebug-3.0.2-7.2-vc15-nts-x86_64.dll
zend_extension=xdebug-3.0.2-7.2-vc15-nts-x86_64

[XDebug]
; XDebug 2
; xdebug.remote_enable=1
; xdebug.remote_autostart=1

; XDebug 3
xdebug.mode=debug
xdebug.start_with_request=yes
; xdebug.client_port=9003<br>xdebug.log_level=0</pre>
      <p>Chú ý: Ở XDebug 2, chúng ta nên chỉnh lại cổng của xdebug, đổi từ mặc
        định 9000 sang 9003 để tránh trùng với cổng của PHP-FPM. Ở XDebug
        2,&nbsp; tên cấu hình là <code>xdebug.remote_port</code>. Ở XDebug 3,
        tên cấu hình là xdebug.client_port và cổng mặc định là 9003.</p>
      <p>Thêm cấu hình <code>xdebug.log_level=0</code> để disable log lỗi mỗi
        khi chạy php-cli hoặc php-fpm. Lỗi là:</p>
      <pre class="text-pre-wrap">Xdebug: [Step Debug] Time-out connecting to debugging client, waited: 200 ms. Tried: localhost:9003 (through xdebug.client_host/xdebug.client_port) :-(</pre>
      <p>Restart lại server. Kiểm tra lại thông tin xdebug ở <code>phpinfo()</code>.</p>
      <div class="mb-3 border"><img src="images/xdebug%20info.png" alt=""></div>
      <h3>Cài đặt VSCode extension PHP Debug</h3>
      <p>Địa chỉ web:</p>
      <p><a href="https://marketplace.visualstudio.com/items?itemName=felixfbecker.php-debug"
          target="_blank">PHP Debug - Visual Studio Marketplace</a></p>
      <p>Cài đặt, khởi động lại để sử dụng.</p>
      <h3>Sử dụng debug</h3>
      <p>Click vào biểu tượng Run ở bên trái của VSCode.</p>
      <p>Chọn tùy chọn "Listen for XDebug".</p>
      <p>Chọn biểu tượng Play hoặc nhấn F5 để bắt đầu debug.</p>
      <p>Đặt breakpoint</p>
      <p>Khởi tạo debug</p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <h3>Tham khảo</h3>
      <p><a href="https://stackify.com/php-debugging-guide/" target="_blank">A
          Detailed Guide to PHP Debugging – Stackify</a></p>
      <p><a href="https://scotch.io/@chenster/debugging-php-in-visual-studio-code205"
          target="_blank">Debugging PHP in Visual Studio Code ― Scotch.io</a></p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
    </article>
    <script src="../../js/docs.js"></script>
  </body>
</html>
