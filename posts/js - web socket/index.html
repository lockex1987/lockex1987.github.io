<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Web Socket client and server, chat, ratchet">
    <title>Web Socket</title>
    <link rel="icon" href="../../images/favicon.png">
    <link rel="stylesheet" href="../../css/style.css">
  </head>
  <body>
    <article>
      <h2>Web Socket</h2>
      <p>Web Socket là công nghệ giao tiếp hai chiều cho các ứng dụng web mà
        điều hành qua một Socket đơn và được tiếp xúc thông qua một giao diện
        JS.</p>
      <p>Một khi bạn có một kết nối Web Socket với Server, bạn có thể gửi dữ
        liệu từ trình duyệt tới Server bằng cách gọi một phương thức <code>send()</code>,
        và nhận dữ liệu từ Server tới trình duyệt bằng cách bắt sự kiện <code>message</code>.</p>
      <h3>Các sự kiện Web Socket</h3>
      <p>Giả sử chúng ta tạo một đối tượng Web Socket mới như sau:</p>
      <pre>const ws = new WebSocket(url);</pre>
      <p>Sau đây là các sự kiện được liên kết với đối tượng Web Socket.</p>
      <div class="out-of-box">
        <table class="table table-bordered">
          <tbody>
            <tr>
              <th width="25%">Sự kiện</th>
              <th>Miêu tả</th>
            </tr>
            <tr>
              <td><code>open</code></td>
              <td>Sự kiện này xảy ra khi kết nối Socket được thành lập</td>
            </tr>
            <tr>
              <td><code>message</code></td>
              <td>Sự kiện này xảy ra khi Client nhận dữ liệu từ Server</td>
            </tr>
            <tr>
              <td><code>error</code></td>
              <td>Sự kiện này xảy ra khi có bất kỳ lỗi nào trong giao tiếp</td>
            </tr>
            <tr>
              <td><code>close</code></td>
              <td>Sự kiện này xảy ra khi kết nối được đóng</td>
            </tr>
          </tbody>
        </table>
      </div>
      <h3>Các phương thức Web Socket</h3>
      <p>Sau đây là các phương thức liên kết với đối tượng Web Socket.</p>
      <div class="out-of-box">
        <table class="table table-bordered">
          <tbody>
            <tr>
              <th width="30%">Phương thức</th>
              <th>Miêu tả</th>
            </tr>
            <tr>
              <td><code>ws.send(data)</code></td>
              <td>Truyền tải dữ liệu sử dụng kết nối đó</td>
            </tr>
            <tr>
              <td><code>ws.close()</code></td>
              <td>Kết thúc bất kỳ kết nối đang tồn tại</td>
            </tr>
          </tbody>
        </table>
      </div>
      <h3>Xác thực với Web Socket</h3>
      <p>Chúng ta không thể thêm vào header khi kết nối, chỉ có thể thêm tham số
        vào URL. Có thể sử dụng cookie.</p>
      <p><strong>Cách 1</strong>: Client truyền thêm token khi kết nối. Như thế
        thì hiển thị token trên URL.</p>
      <p><strong>Cách 2</strong>: Client truyền ticket dùng một lần khi kết nối.</p>
      <p><strong>Cách 3</strong>: Client truyền thêm token ở lần gọi đầu tiên
        (sự kiện <code>open</code>).</p>
      <p><strong>Cách 4</strong>: Thêm cookie trước khi khởi tạo. Xóa cookie sau
        khi <code>open</code> hoặc <code>close</code> hoặc <code>error</code>.</p>
      <h3>Demo</h3>
      <p><a href="websocket-client/index.html">Web Socket client</a></p>
      <h3>Tham khảo</h3>
      <p><a href="http://socketo.me/" target="_blank">Ratchet - PHP
          WebSockets</a></p>
      <p><a href="https://github.com/websockets/ws" target="_blank">websockets/ws:
          Simple to use, blazing fast WebSocket for Node.js</a></p>
    </article>
    <script src="../../js/docs.js"></script>
  </body>
</html>
