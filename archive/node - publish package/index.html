<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Publish một package lên npm">
    <title>Publish một package lên npm</title>
    <link rel="icon" href="../../images/favicon.png">
    <link rel="stylesheet" href="../../css/style.css">
  </head>
  <body>
    <article>
      <h2>Publish một package lên npm</h2>
      <p>Nếu bạn có một package nào đó muốn chia sẽ cùng mọi người trên npm, thì
        đây là cách bạn publish package make-by-me như vậy lên npm.</p>
      <h3>Package là gì, module là gì</h3>
      <p>Npm sẽ phân biệt 2 khái niệm&nbsp;<strong>package</strong>&nbsp;và&nbsp;<strong>module</strong>.</p>
      <p><strong>Package</strong>&nbsp;là một thư mục chứa một gói phần mềm được
        mô tả bởi file <code>package.json</code>.</p>
      <p><strong>Module</strong>&nbsp;là một thư mục chứa file <code>package.json</code>,
        chứa một&nbsp;<code>default export</code>, cho phép loading module này
        bằng&nbsp;<code>require()</code>&nbsp;trong Node.</p>
      <p>Thư mục&nbsp;<strong>node_modules</strong>&nbsp;là nơi mà thằng Node sẽ
        tìm các module cần thiết.</p>
      <p>Một cách tóm tắt, hầu hết các npm package chúng ta cài là module, tuy
        nhiên không nhất thiết npm package là module.</p>
      <p>Những package CLI chỉ chứa các đoạn command-line, chúng ta ko thể load
        được bằng require, kiểu package như vậy không thể xem là module.</p>
      <p>Module là được load từ một file như thế này mới xem là module:</p>
      <pre>const acronym = require('acronym');</pre>
      <h3>Cài đặt</h3>
      <p>Tạo một thư mục trống, init package npm mới bằng&nbsp;<code>npm init</code>&nbsp;hoặc&nbsp;<code>npm
          init --yes</code>&nbsp;nếu muốn trả lời yes cho tất cả các câu hỏi.</p>
      <pre>mkdir acronym &amp;&amp; cd acronym
npm init --yes</pre>
      <p>Trỏ vào thư mục này, chúng ta sẽ có file&nbsp;<code>package.json</code>&nbsp;như
        sau:</p>
      <pre>{
    "name": "acronym",
    "version": "1.0.0",
    "description": "",
    "main": "index.js",
    "scripts": {
        "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"
    },
    "author": "",
    "license": "ISC"
}</pre>
      <p>Theo mặc định, một sẽ có 1 file&nbsp;<code>index.js</code>, với&nbsp;<code>default
          export</code>.</p>
      <p>Sửa file&nbsp;<code>package.json</code>, để bổ sung thông tin tác giả,
        chúng ta đi theo nguyên tắc là&nbsp;<code>Your name
          &lt;email@example.com&gt;</code>.</p>
      <pre>{
    "name": "acronym",
    "version": "1.0.0",
    "description": "Transform sentences to acronyms.",
    "main": "index.js",
    "author": "luubinhan &lt;luubinhan@gmail.me&gt;"
}</pre>
      <p>File&nbsp;<code>index.js</code>&nbsp;nội dung đại loại sẽ như thế này:</p>
      <pre>"use strict";

module.exports = function acronym(sentence, callback) {

};</pre>
      <h3>Kiểm tra</h3>
      <p>Trước khi publish nó lên npm, trong ta có thể dùng&nbsp;<code>npm link</code>&nbsp;để
        kiểm tra dưới local trước. Đại khái&nbsp;<code>npm link</code>&nbsp;sẽ
        cho phép chúng ta trỏ thư mục package vào thư mục&nbsp;<code>node_modules</code>&nbsp;global.
        Chúng ta cần thực hiện hai bước:</p>
      <pre>cd ~/duong-dan-toi-thu-muc/acronym
npm link</pre>
      <p>Sau đó, trong thư mục sử dụng package:</p>
      <pre><code>cd ~/duong-dan-toi-thu-muc/project-nao-do
npm link acronym</code></pre>
      <p>Bên trong thư mục&nbsp;<strong>node_modules</strong>&nbsp;bây giờ sẽ
        như thế này:</p>
      <p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_900,q_auto:good,f_auto/media/16958/DAUsrFheT8GoWDgais3E_Screen%20Shot%202017-06-26%20at%205.59.29%20PM.png"></p>
      <h3>Publish</h3>
      <p>Nếu package chúng ta bị trùng tên trên npm, sẽ nhận thông báo khi
        publish:</p>
      <p><img src="https://scotch-res.cloudinary.com/image/upload/dpr_1,w_900,q_auto:good,f_auto/media/16958/Ib1IU5lWQfSrmfi23EOU_Screen%20Shot%202017-06-09%20at%2012.35.50%20PM%20%282%29.png"></p>
      <p>Tất nhiên trước khi có quyền publish lên npm chúng ta phải tạo một user
        trên npm, bằng lệnh&nbsp;<code>npm adduser</code>&nbsp;hoặc lên site nó
        đăng ký. Sau đó login bằng&nbsp;<code>npm login</code>&nbsp;để nó nhớ
        chúng ta.</p>
      <p>Có thể kiểm tra npm có nhớ chúng ta chưa bằng&nbsp;<code>npm whoami</code>&nbsp;(tui
        là ai).</p>
      <p>Mọi thứ đã hoàn tất,&nbsp;<code>npm publish</code>&nbsp;để trình làng
        một module cho thiên hạ:</p>
      <pre>npm publish</pre>
      <p>Package sau khi publish sẽ nằm ở đây&nbsp;<code>https://npmjs.com/package/&lt;package&gt;</code>.</p>
      <p>Ngày nó đó ko muốn cho thiên hạ xài nữa:</p>
      <pre>npm unpublish</pre>
      <p>Khi cần update lên version mới:</p>
      <pre>npm version &lt;update_type&gt;</pre>
      <h3>TODO</h3>
      <p>Publish các thư viện common-validation, noti, datatable.</p>
      <h3>Tham khảo</h3>
      <p><a href="http://vuilaptrinh.com/2019-06-06-huong-dan-publish-package-len-npm/"
          target="_blank">Hướng dẫn tạo một package, publish nó lên npm |
          vuilaptrinh</a></p>
      <p><a href="https://scotch.io/bar-talk/how-to-build-and-publish-a-npm-package"
          target="_blank">How to Build and Publish an npm Package ― Scotch.io</a></p>
    </article>
    <script src="../../js/docs.js"></script>
  </body>
</html>
