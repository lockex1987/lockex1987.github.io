<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="phpspreadsheet, export from template, merge cell, chart, TODO: packagist">
    <title>Thao tác file Excel với PHP</title>
    <link rel="icon" href="../../images/favicon.png">
    <link rel="stylesheet" href="../../css/style.css">
  </head>
  <body>
    <article>
      <h2>Thao tác file Excel với PHP</h2>
      <h3>Roadmap dự án</h3>
      <p>Làm chức năng export thôi.</p>
      <p>Chức năng import sẽ dùng exceljs đọc từng dòng, insert từng dòng.</p>
      <p>Chức năng export của exceljs có API khá là tiện, nhưng nếu dùng được
        bằng template thì tốt.</p>
      <p><a href="../../posts.html?searchAll=true&amp;query=excel" target="_blank">Posts
          "excel"</a></p>
      <p>Ở dự án TTCD, export Excel bằng thư viện Laravel Excel phiên bản 2 với
        Blade template cùng CSS rất là tiện.</p>
      <p>Tuy nhiên, Laravel Excel phiên bản 2 chỉ hỗ trợ các framework Laravel
        phiên bản thấp (Laravel 8 sẽ không có). Laravel Excel phiên bản 3 thì
        lại bỏ tính năng này (không format bằng CSS được).</p>
      <p>Chúng ta sẽ tự viết bằng PHPSpreadsheet.</p>
      <p>Chúng ta cần nắm các khái niệm:</p>
      <h4>Template engine</h4>
      <p>Template engine: từ template và dữ liệu sẽ sinh ra xâu đầu ra với dữ
        liệu được thể hiển. Có hỗ trợ các block như if-else, for loop,...</p>
      <p>Template được hỗ trợ nhiều ngôn ngữ lập trình nhất là Mustache.</p>
      <p>Có thể tự viết:</p>
      <p><a href="../js%20-%20my%20own%20repeat%20template/" target="_blank">Repeat
          template</a></p>
      <p><a href="https://www.w3schools.com/w3js/w3js_w3data.asp" target="_blank">W3.JS
          W3Data</a></p>
      <p><a href="https://github.com/janl/mustache.js/blob/master/mustache.js" target="_blank">mustache.js/mustache.js
          at master · janl/mustache.js · GitHub</a></p>
      <p><a href="https://en.wikipedia.org/wiki/Mustache_%28template_system%29"

          target="_blank">Mustache (template system) - Wikipedia</a></p>
      <p>Thư viện Jxls có sử dụng template ở file Excel (trong comment của ô?):</p>
      <p><a href="http://jxls.sourceforge.net/" target="_blank">JXLS<br>
        </a></p>
      <p><a href="https://github.com/jxlsteam/jxls" target="_blank">GitHub -
          jxlsteam/jxls: Java library for creating Excel reports using Excel
          templates</a></p>
      <h3>Cấu trúc file xlsx</h3>
      <p>File xlsx là file ZIP của các file xml, đo đó chúng ta cần biết các
        thao tác với file ZIP (nén, giải nén, đọc, cập nhật).</p>
      <p><a href="https://lockex1987.github.io/posts/js%20-%20export%20docx/" target="_blank">Xuất
          file docx với JS</a></p>
      <p><a href="https://lockex1987.github.io/posts/php%20-%20zip/" target="_blank">Thao
          tác với ZIP file bằng PHP</a></p>
      <p>Mô tả Office Open XML:</p>
      <p><a href="http://officeopenxml.com/anatomyofOOXML-xlsx.php" target="_blank">Office
          Open XML - Anatomy of an OOXML SpreadsheetML File</a></p>
      <p><a href="http://officeopenxml.com/SScontentOverview.php" target="_blank">Office
          Open XML (OOXML) - Word Processing - Overview of Content</a></p>
      <p>Code đơn giản:</p>
      <p><a href="https://gist.github.com/kasparsd/ade34dd94a80b97fb9ec59391a0c620f"

          target="_blank">Generate the most basic Excel XLSX and XML files in
          PHP, see https://kaspars.net/blog/wordpress/excel-xlsx-xml-php ·
          GitHub</a></p>
      <p><a href="https://github.com/kasparsd/mini-sheets-php" target="_blank">GitHub
          - kasparsd/mini-sheets-php: Library for creating the most basic Office
          Open XML and Excel XLSX files.</a></p>
      <p><a href="https://github.com/shuchkin/simplexlsxgen" target="_blank">GitHub
          - shuchkin/simplexlsxgen: Export data to Excel. PHP XLSX generator</a></p>
      <p><br>
      </p>
      <p><br>
      </p>
      <p><br>
      </p>
      <h3>Các thư viện tham khảo</h3>
      <p><a href="https://github.com/linways/table-to-excel" target="_blank">GitHub
          - linways/table-to-excel: Javascript library to create "valid" excel
          file from html table with styles</a></p>
      <p><a href="https://github.com/optilude/xlsx-template" target="_blank">GitHub
          - optilude/xlsx-template: A NodeJS module to generate Excel files in
          .xlsx format from a template created with Excel itself</a></p>
      <p><a href="https://docs.laravel-excel.com/2.1/blade/styling.html" target="_blank">Styling
          sheets | Laravel Excel</a></p>
      <p><a href="https://docs.laravel-excel.com/2.1/blade/load-view.html" target="_blank">@Blade
          to Excel | Laravel Excel</a></p>
      <p><a href="https://github.com/PHPOffice/PhpSpreadsheet/blob/master/src/PhpSpreadsheet/Reader/Html.php"

          target="_blank">PhpSpreadsheet/Html.php at master ·
          PHPOffice/Php…</a> </p>
      <p>Code Java do tôi viết:</p>
      <p><a href="https://github.com/lockex1987/lockex1987.github.io/blob/master/posts/java%20-%20cttd/cttd/src/main/java/common/util/ExportExcel.java"

          target="_blank">https://github.com/lockex1987/lockex1987.github.io/blob/master/posts/java%20-%20cttd/cttd/src/main/java/common/util/ExportExcel.java</a></p>
      <p><a href="https://github.com/lockex1987/lockex1987.github.io/blob/master/posts/java%20-%20cttd/cttd/src/main/java/common/util/ExcelValidator.java"

          target="_blank">https://github.com/lockex1987/lockex1987.github.io/blob/master/posts/java%20-%20cttd/cttd/src/main/java/common/util/ExcelValidator.java</a></p>
      <p><a href="https://github.com/lockex1987/lockex1987.github.io/blob/master/posts/java%20-%20cttd/cttd/src/main/java/common/util/ExcelToDatabase.java"

          target="_blank">https://github.com/lockex1987/lockex1987.github.io/blob/master/posts/java%20-%20cttd/cttd/src/main/java/common/util/ExcelToDatabase.java</a></p>
      <h3>Chức năng</h3>
      <ul>
        <li>Xuất từ template</li>
        <ul>
          <li>Có if-else, for, merge cell</li>
        </ul>
        <li>Có thể vẽ biểu đồ</li>
      </ul>
      <p><br>
      </p>
      <p><br>
      </p>
      <h3>Các thư viện PHP<br>
      </h3>
      <p>Đọc, ghi file Excel.</p>
      <p>Có thể ghi với định dạng PDF.</p>
      <p>Có 3 thư viện hay được dùng:</p>
      <ul>
        <li><a target="_blank" href="https://packagist.org/packages/phpoffice/phpexcel">https://packagist.org/packages/phpoffice/phpexcel</a></li>
        <li><a target="_blank" href="https://packagist.org/packages/phpoffice/phpspreadsheet">https://packagist.org/packages/phpoffice/phpspreadsheet</a></li>
        <li><a target="_blank" href="https://packagist.org/packages/maatwebsite/excel">https://packagist.org/packages/maatwebsite/excel</a></li>
      </ul>
      <p>Thư viện PHPExcel đã cũ, không được phát triển nữa.</p>
      <p>Thư viện thứ 3 sử dụng cho framework Laravel.</p>
      <p>Sử dụng thư viện phpspreadsheet. Thư viện này là thư viện mới của
        PHPExcel, được chính nhà phát triển thư viện PHPExcel đề nghị.</p>
      <h3>Thư viện PHPSpreadsheet</h3>
      <p>Các định dạng cho phép đọc:</p>
      <ul>
        <li>Office Open XML (.xlsx) Excel 2007 trở lên</li>
        <li>BIFF 8 (.xls) Excel 97 trở lên</li>
        <li>BIFF 5 (.xls) Excel 95</li>
        <li>Open Document Format/OASIS (.ods)</li>
        <li>SpreadsheetML (.xml) Excel 2003</li>
        <li>CSV</li>
        <li>HTML</li>
        <li>Gnumeric</li>
        <li>SYLK</li>
      </ul>
      <p>Các định dạng cho phép ghi:</p>
      <ul>
        <li>Office Open XML (.xlsx) Excel 2007 trở lên</li>
        <li>BIFF 8 (.xls) Excel 97 trở lên</li>
        <li>Open Document Format/OASIS (.ods)</li>
        <li>CSV</li>
        <li>HTML</li>
        <li>PDF</li>
      </ul>
      <p>Cài đặt:</p>
      <pre>composer require phpoffice/phpspreadsheet</pre>
      <p>Code mẫu</p>
      <p><a target="_blank" href="phpspreadsheet/phpspreadsheet_demo.php">phpspreadsheet_demo.php</a></p>
      <h3>Tham khảo</h3>
      <p><a target="_blank" href="https://phpspreadsheet.readthedocs.io/en/latest/">https://phpspreadsheet.readthedocs.io/en/latest/</a></p>
      <p><a target="_blank" href="https://viblo.asia/p/importexport-du-lieu-tu-file-excel-su-dung-thu-vien-phpexcel-L4x5xQAYKBM">https://viblo.asia/p/importexport-du-lieu-tu-file-excel-su-dung-thu-vien-phpexcel-L4x5xQAYKBM</a></p>
      <p><a target="_blank" href="https://chungnguyen.xyz/posts/laravel-excel-import-100-000-record-mat-bao-lau">https://chungnguyen.xyz/posts/laravel-excel-import-100-000-record-mat-bao-lau</a></p>
      <p><br>
      </p>
      <p><br>
      </p>
    </article>
    <script src="../../js/docs.js"></script>
  </body>
</html>
